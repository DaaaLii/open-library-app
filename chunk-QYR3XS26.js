import{a as B,b as T}from"./chunk-NZYOSJQQ.js";import{D as v,E as C,I as p,L as l,M as o,N as t,O as m,S as w,T as d,U as b,W as i,X as u,Y as h,c as y,ca as I,da as M,ea as _,k,ka as O,la as D,ma as S,na as E,q as g,sa as P,t as f,ua as j,va as R,y as x,z as s}from"./chunk-MFVN2OO6.js";function U(e){e||(e=g(f));let r=new y(n=>{if(e.destroyed){n.next();return}return e.onDestroy(n.next.bind(n))});return n=>n.pipe(k(r))}function L(e,r){e&1&&(o(0,"div",10)(1,"div",11),m(2,"div",12)(3,"div",13)(4,"div",14),t(),o(5,"div",15),m(6,"div",16)(7,"div",17)(8,"hr",18)(9,"div",19)(10,"div",20)(11,"div",21),t()())}function A(e,r){if(e&1&&(o(0,"div",22)(1,"div",23)(2,"span",5),i(3,"error"),t()(),o(4,"div")(5,"h3"),i(6,"Erreur"),t(),o(7,"p",24),i(8),t(),o(9,"a",25)(10,"span",5),i(11,"home"),t(),i(12," Retour accueil "),t()()()),e&2){let n=d();s(8),u(n.error)}}function z(e,r){if(e&1&&m(0,"img",37),e&2){let n=d(2);l("src",n.coverUrl(),x)("alt",n.title())}}function N(e,r){e&1&&(o(0,"div",38)(1,"span",5),i(2,"image_not_supported"),t(),i(3," Sans cover "),t())}function $(e,r){if(e&1&&(o(0,"p",39),i(1),t()),e&2){let n=d(2);s(),u(n.subtitle())}}function J(e,r){if(e&1&&(o(0,"p",40),i(1),t()),e&2){let n=d(2);s(),u(n.desc())}}function V(e,r){e&1&&(o(0,"p",24),i(1,"Aucune description disponible."),t())}function G(e,r){if(e&1&&(o(0,"span",44)(1,"span",5),i(2,"label"),t(),i(3),t()),e&2){let n=r.$implicit;s(3),h(" ",n," ")}}function H(e,r){if(e&1&&(o(0,"div",41)(1,"h3",33),i(2,"Sujets"),t(),o(3,"div",42),p(4,G,4,1,"span",43),t()()),e&2){let n=d(2);s(4),l("ngForOf",n.subjects())}}function K(e,r){if(e&1&&(o(0,"div",26)(1,"div",11)(2,"div",27),p(3,z,1,2,"img",28)(4,N,4,0,"ng-template",null,0,_),t(),o(6,"div",29)(7,"span",30)(8,"span",5),i(9,"tag"),t(),i(10),t()()(),o(11,"div",15)(12,"h1",31),i(13),t(),p(14,$,2,1,"p",32),m(15,"hr",18),o(16,"h3",33),i(17,"Description"),t(),p(18,J,2,1,"p",34)(19,V,2,0,"ng-template",null,1,_)(21,H,5,1,"div",35),o(22,"details",36)(23,"summary"),i(24,"Voir le JSON brut"),t(),o(25,"pre"),i(26),I(27,"json"),t()()()()),e&2){let n=b(5),a=b(20),c=d();s(3),l("ngIf",c.coverUrl())("ngIfElse",n),s(7),h(" ID: ",c.id," "),s(3),u(c.title()),s(),l("ngIf",c.subtitle()),s(4),l("ngIf",c.desc())("ngIfElse",a),s(3),l("ngIf",c.subjects().length),s(5),u(M(27,9,c.book))}}var q=class{},F=class e{constructor(r,n,a){this.route=r;this.router=n;this.bookService=a}destroyRef=g(f);loading=!0;error=null;id="";book=null;ngOnInit(){if(this.id=String(this.route.snapshot.paramMap.get("id")??"").trim(),!this.id){this.loading=!1,this.error="ID manquant.";return}this.bookService.getBookById(this.id).pipe(U(this.destroyRef)).subscribe(r=>{this.book=r,this.loading=!1,r||(this.error="Livre introuvable.")})}back(){this.router.navigate(["/"])}coverUrl(){let r=Array.isArray(this.book?.covers)&&this.book.covers.length?this.book.covers[0]:0;return r?`${B.coversBaseUrl}/${r}-L.jpg`:""}title(){return String(this.book?.title??"")}subtitle(){return String(this.book?.subtitle??"")}desc(){return this.bookService.normalizeDescription(this.book?.description)}subjects(){return Array.isArray(this.book?.subjects)?this.book.subjects.slice(0,18):[]}openLibraryUrl(){return`https://openlibrary.org/works/${this.id}`}static \u0275fac=function(n){return new(n||e)(v(P),v(j),v(T))};static \u0275cmp=C({type:e,selectors:[["app-book-details"]],decls:13,vars:4,consts:[["noCover",""],["noDesc",""],[1,"wrap"],[1,"top"],[1,"btn","ghost",3,"click"],[1,"material-symbols-rounded"],["target","_blank","rel","noopener",1,"btn","primary",3,"href"],["class","card panel",4,"ngIf"],["class","card state error",4,"ngIf"],["class","card panel layout",4,"ngIf"],[1,"card","panel"],[1,"left"],[1,"cover","skeleton"],[1,"skeleton",2,"height","18px","width","70%"],[1,"skeleton",2,"height","14px","width","50%"],[1,"right"],[1,"skeleton",2,"height","28px","width","80%"],[1,"skeleton",2,"height","16px","width","55%"],[1,"sep"],[1,"skeleton",2,"height","14px","width","100%"],[1,"skeleton",2,"height","14px","width","92%"],[1,"skeleton",2,"height","14px","width","86%"],[1,"card","state","error"],[1,"icon"],[1,"muted"],["routerLink","/",1,"btn","primary"],[1,"card","panel","layout"],[1,"cover"],[3,"src","alt",4,"ngIf","ngIfElse"],[1,"mini"],[1,"badge"],[1,"title"],["class","subtitle",4,"ngIf"],[1,"h3"],["class","desc",4,"ngIf","ngIfElse"],["class","subjects",4,"ngIf"],[1,"raw"],[3,"src","alt"],[1,"noCover"],[1,"subtitle"],[1,"desc"],[1,"subjects"],[1,"chips"],["class","chip",4,"ngFor","ngForOf"],[1,"chip"]],template:function(n,a){n&1&&(o(0,"section",2)(1,"div",3)(2,"button",4),w("click",function(){return a.back()}),o(3,"span",5),i(4,"arrow_back"),t(),i(5," Retour "),t(),o(6,"a",6)(7,"span",5),i(8,"open_in_new"),t(),i(9," OpenLibrary "),t()(),p(10,L,12,0,"div",7)(11,A,13,1,"div",8)(12,K,28,11,"div",9),t()),n&2&&(s(6),l("href",a.openLibraryUrl(),x),s(4),l("ngIf",a.loading),s(),l("ngIf",!a.loading&&a.error),s(),l("ngIf",!a.loading&&!a.error&&a.book))},dependencies:[E,O,D,R,S],styles:[".wrap[_ngcontent-%COMP%]{display:grid;gap:14px}.top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}.panel[_ngcontent-%COMP%]{padding:16px}.layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:360px 1fr;gap:16px}.left[_ngcontent-%COMP%]{display:grid;gap:12px;align-content:start}.right[_ngcontent-%COMP%]{display:grid;gap:10px}.cover[_ngcontent-%COMP%]{width:100%;height:520px;border-radius:18px;overflow:hidden;border:1px solid rgba(255,255,255,.12);background:#0003;display:grid;place-items:center;box-shadow:0 22px 70px #0000008c}.cover[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.noCover[_ngcontent-%COMP%]{display:grid;place-items:center;gap:10px;color:#a6b3d6f2}.title[_ngcontent-%COMP%]{margin:0;font-size:clamp(22px,2.4vw,34px);letter-spacing:.2px}.subtitle[_ngcontent-%COMP%]{margin:0;color:#a6b3d6f2}.h3[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#eaf0ffeb;letter-spacing:.2px}.desc[_ngcontent-%COMP%]{margin:0;line-height:1.65;color:#eaf0ffeb}.mini[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.subjects[_ngcontent-%COMP%]{margin-top:6px}.chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:#ffffff0d;color:#eaf0ffe6;font-size:12px}.chip[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:16px;color:#a6b3d6f2}.raw[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{cursor:pointer;color:#a6b3d6f2}pre[_ngcontent-%COMP%]{white-space:pre-wrap;word-break:break-word;background:#00000040;border:1px solid rgba(255,255,255,.1);padding:12px;border-radius:14px;max-height:320px;overflow:auto}.state[_ngcontent-%COMP%]{padding:18px;display:flex;align-items:flex-start;gap:14px}.state[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:16px;display:grid;place-items:center;border:1px solid rgba(255,255,255,.14);background:#ffffff0f}.state.error[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 6px;color:#ff8aa0}.muted[_ngcontent-%COMP%]{color:#a6b3d6f2;margin:0}@media (max-width: 980px){.layout[_ngcontent-%COMP%]{grid-template-columns:1fr}.cover[_ngcontent-%COMP%]{height:420px}}"]})};export{q as BookDetails,F as BookDetailsComponent};
